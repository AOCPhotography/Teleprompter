<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Teleprompter Pro</title>
  <style>
    body {
      background: black;
      color: white;
      margin: 0;
      font-size: 48px;
      font-family: Arial, sans-serif;
      overflow-y: scroll;
    }
    #controls {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: rgba(0,0,0,0.85);
      padding: 4px 10px;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 4px;
      z-index: 9999;
    }
    .control-button, select {
      height: 32px;
      min-width: 32px;
      font-size: 16px;
      background: #222;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .control-button:hover {
      background: #444;
    }
    .slider {
      width: 80px;
      height: 20px;
    }
    #script {
      padding: 120px 80px 60px 80px;
      max-width: 1000px;
      margin: auto;
      white-space: pre-wrap;
      outline: none;
      transform: scaleX(-1);
    }
    input[type="file"] {
      height: 32px;
      font-size: 14px;
    }
    .highlight-grey {
      background-color: #ccc;
      color: black;
    }
    .highlight-yellow {
      background-color: yellow;
      color: black;
    }
    .highlight-blue {
      background-color: lightblue;
      color: black;
    }
    .highlight-green {
      background-color: lightgreen;
      color: black;
    }
    .highlight-red {
      background-color: pink;
      color: black;
    }
  </style>
</head>
<body>
  <div id="controls">
    <button class="control-button" onclick="saveScript()">üíæ</button>
    <input type="file" id="fileInput" accept=".txt" />
    <button class="control-button" onclick="toggleEdit()">‚úèÔ∏è</button>
    <button class="control-button" onclick="toggleMirror()">üîÅ</button>
    <button class="control-button" onclick="highlightSelection('highlight-grey')">‚ö´</button>
    <button class="control-button" onclick="highlightSelection('highlight-yellow')">üü®</button>
    <button class="control-button" onclick="highlightSelection('highlight-blue')">üîµ</button>
    <button class="control-button" onclick="highlightSelection('highlight-green')">üü¢</button>
    <button class="control-button" onclick="highlightSelection('highlight-red')">üî¥</button>
    <button class="control-button" onclick="removeHighlight()">‚ùå</button>
    <button class="control-button" onclick="jumpToNextHighlight()">‚è©</button>

    <select id="fontColor" onchange="changeTextColor()">
      <option value="">üé®</option>
      <option value="white">White</option>
      <option value="black">Black</option>
      <option value="red">Red</option>
      <option value="yellow">Yellow</option>
      <option value="blue">Blue</option>
      <option value="green">Green</option>
    </select>

    <select id="fontSize" onchange="changeTextSize()">
      <option value="">üî†</option>
      <option value="24px">Small</option>
      <option value="48px">Medium</option>
      <option value="72px">Large</option>
      <option value="96px">X-Large</option>
    </select>

    <input class="slider" type="range" id="speedSlider" min="0.5" max="10" step="0.5" value="2" />
    <input class="slider" type="range" id="fontSlider" min="16" max="96" step="2" value="48" />

    <div style="flex: 1;"></div>

    <button class="control-button" onclick="togglePlay()">‚ñ∂Ô∏è/‚è∏Ô∏è</button>
    <button class="control-button" onclick="toggleFullscreen()">‚õ∂</button>
  </div>

  <div id="script" contenteditable="true">Paste your teleprompter script here...</div>

  <script>
    const script = document.getElementById("script");
    const fileInput = document.getElementById("fileInput");
    const speedSlider = document.getElementById("speedSlider");
    const fontSlider = document.getElementById("fontSlider");
    let isPlaying = false;
    let scrollSpeed = parseFloat(speedSlider.value);
    let scrollInterval;
    let fontSize = parseInt(fontSlider.value);

    // Load saved script
    script.innerHTML = localStorage.getItem("teleprompterScript") || script.innerHTML;

    script.addEventListener("input", () => {
      localStorage.setItem("teleprompterScript", script.innerHTML);
    });

    function togglePlay() {
      isPlaying = !isPlaying;
      clearInterval(scrollInterval);
      if (isPlaying) {
        scrollInterval = setInterval(() => {
          window.scrollBy(0, scrollSpeed);
        }, 16);
      }
    }

    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
      } else {
        document.exitFullscreen();
      }
    }

    function toggleMirror() {
      script.style.transform = script.style.transform === "none" ? "scaleX(-1)" : "none";
    }

    function toggleEdit() {
      script.contentEditable = script.isContentEditable ? "false" : "true";
    }

    function saveScript() {
      const blob = new Blob([script.innerHTML], { type: "text/html;charset=utf-8" });
      const link = document.createElement("a");
      link.download = "teleprompter-script.html";
      link.href = URL.createObjectURL(blob);
      link.click();
    }

    function highlightSelection(className) {
      const selection = window.getSelection();
      if (!selection.rangeCount) return;
      const range = selection.getRangeAt(0);
      const span = document.createElement("span");
      span.className = className;
      range.surroundContents(span);
      script.focus();
    }

    function removeHighlight() {
      const highlights = script.querySelectorAll("span[class^='highlight']");
      highlights.forEach(span => {
        const parent = span.parentNode;
        while (span.firstChild) parent.insertBefore(span.firstChild, span);
        parent.removeChild(span);
      });
    }

    function jumpToNextHighlight() {
      const highlights = script.querySelectorAll("span[class^='highlight']");
      const scrollY = window.scrollY;
      for (let span of highlights) {
        const top = span.getBoundingClientRect().top + window.scrollY;
        if (top > scrollY + 10) {
          window.scrollTo({ top: top - 80, behavior: 'smooth' });
          break;
        }
      }
    }

    function changeTextColor() {
      const color = document.getElementById("fontColor").value;
      document.execCommand("foreColor", false, color);
    }

    function changeTextSize() {
      const size = document.getElementById("fontSize").value;
      document.execCommand("fontSize", false, "7");
      const fontElements = script.querySelectorAll("font[size='7']");
      fontElements.forEach(el => {
        el.removeAttribute("size");
        el.style.fontSize = size;
      });
    }

    fileInput.addEventListener("change", (e) => {
      const reader = new FileReader();
      reader.onload = () => {
        script.innerHTML = reader.result;
        localStorage.setItem("teleprompterScript", script.innerHTML);
      };
      reader.readAsText(e.target.files[0]);
    });

    speedSlider.addEventListener("input", () => {
      scrollSpeed = parseFloat(speedSlider.value);
    });

    fontSlider.addEventListener("input", () => {
      fontSize = parseInt(fontSlider.value);
      script.style.fontSize = fontSize + "px";
    });

    document.addEventListener("keydown", (e) => {
      if (e.ctrlKey && e.shiftKey) {
        if (e.key === "1") speedSlider.value = Math.max(0.5, parseFloat(speedSlider.value) - 0.5);
        if (e.key === "2") speedSlider.value = Math.min(10, parseFloat(speedSlider.value) + 0.5);
        if (e.key === "4") fontSlider.value = Math.max(16, parseInt(fontSlider.value) - 2);
        if (e.key === "5") fontSlider.value = Math.min(96, parseInt(fontSlider.value) + 2);
        scrollSpeed = parseFloat(speedSlider.value);
        fontSize = parseInt(fontSlider.value);
        script.style.fontSize = fontSize + "px";
      }
    });
  </script>
</body>
</html>
